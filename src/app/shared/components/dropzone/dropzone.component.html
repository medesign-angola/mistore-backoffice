<div class="dropzone w-full">
    <form [formGroup]="this.formGroup">
        <label [for]="'file-' + this.name">
            @let errors = this.formGroup.get('file')?.errors;
            <div
            appDragAndDrop
            (fileDropped)="this.dropzoneOnChange($event)"
            class="dropzone-container cursor-pointer relative w-full outline-dashed outline-black rounded-lg"
            >
            <!-- (change)="this.emit()" -->
                @if (showBiggerSvg()) {
                    <div class="image-centered-icon h-[230px] w-full flex justify-center items-center">
                        <svg width="88" height="88" viewBox="0 0 88 88" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M59.1616 17.8383L58.6667 17.3433L57.6767 18.3333L58.1717 18.8282L59.1616 17.8383ZM69.6667 29.3333L69.1717 29.8282C69.4451 30.1016 69.8883 30.1016 70.1616 29.8282L69.6667 29.3333ZM81.1616 18.8282L81.6566 18.3333L80.6667 17.3433L80.1717 17.8383L81.1616 18.8282ZM70.3667 7.33325V6.63325H68.9667V7.33325H70.3667ZM45.8333 11.6999C46.2199 11.6999 46.5333 11.3865 46.5333 10.9999C46.5333 10.6133 46.2199 10.2999 45.8333 10.2999V11.6999ZM17.0061 75.801L16.6883 76.4247L17.0061 75.801ZM12.1989 70.9938L12.8226 70.676L12.8226 70.676L12.1989 70.9938ZM68.847 76.6251L68.6658 75.949L68.847 76.6251ZM77.7 62.3332C77.7 61.9467 77.3866 61.6333 77 61.6333C76.6134 61.6333 76.3 61.9467 76.3 62.3332H77.7ZM76.6252 68.8469L75.949 68.6658L76.6252 68.8469ZM12.1989 17.006L12.8226 17.3238L12.1989 17.006ZM17.0061 12.1988L17.3239 12.8226H17.3239L17.0061 12.1988ZM54.9635 43.6998L55.4343 44.2177L54.9635 43.6998ZM23.9475 71.8961L24.4184 72.414H24.4184L23.9475 71.8961ZM72.8313 51.6649L73.2685 51.1183L72.8313 51.6649ZM62.5747 43.4597L63.012 42.9131L62.5747 43.4597ZM76.8059 56.8485L77.4874 56.6885L76.8059 56.8485ZM75.4353 53.9967L74.8846 54.4289V54.4289L75.4353 53.9967ZM70.3264 76.1134L70.6017 76.757H70.6017L70.3264 76.1134ZM76.1135 70.3263L76.7571 70.6016L76.1135 70.3263ZM21.2536 74.962L21.9492 75.0401L21.2536 74.962ZM21.865 76.5435L21.4028 77.0693L21.865 76.5435ZM57.686 41.6631L57.4697 40.9974L57.686 41.6631ZM59.7292 41.5987L59.5554 42.2767L59.7292 41.5987ZM58.1717 18.8282L69.1717 29.8282L70.1616 28.8383L59.1616 17.8383L58.1717 18.8282ZM70.1616 29.8282L81.1616 18.8282L80.1717 17.8383L69.1717 28.8383L70.1616 29.8282ZM68.9667 7.33325V29.3333H70.3667V7.33325H68.9667ZM62.3333 76.2999H28.6V77.6999H62.3333V76.2999ZM11.7 59.3999V28.5999H10.3V59.3999H11.7ZM28.6 11.6999H45.8333V10.2999H28.6V11.6999ZM28.6 76.2999C25.5082 76.2999 23.2314 76.2994 21.4322 76.1524C19.6412 76.006 18.3853 75.7181 17.3239 75.1773L16.6883 76.4247C17.98 77.0828 19.4407 77.3943 21.3182 77.5477C23.1876 77.7005 25.5313 77.6999 28.6 77.6999V76.2999ZM10.3 59.3999C10.3 62.4687 10.2995 64.8123 10.4522 66.6817C10.6056 68.5593 10.9171 70.02 11.5752 71.3116L12.8226 70.676C12.2818 69.6146 11.9939 68.3587 11.8475 66.5677C11.7005 64.7685 11.7 62.4918 11.7 59.3999H10.3ZM17.3239 75.1773C15.3858 74.1898 13.8101 72.6141 12.8226 70.676L11.5752 71.3116C12.6969 73.5131 14.4868 75.303 16.6883 76.4247L17.3239 75.1773ZM62.3333 77.6999C65.6982 77.6999 67.5179 77.7059 69.0282 77.3012L68.6658 75.949C67.3785 76.2939 65.7883 76.2999 62.3333 76.2999V77.6999ZM76.3 62.3332C76.3 65.7882 76.294 67.3784 75.949 68.6658L77.3013 69.0281C77.706 67.5178 77.7 65.6981 77.7 62.3332H76.3ZM69.0282 77.3012C73.0658 76.2194 76.2195 73.0657 77.3013 69.0281L75.949 68.6658C74.9966 72.2202 72.2203 74.9965 68.6658 75.949L69.0282 77.3012ZM11.7 28.5999C11.7 25.5081 11.7005 23.2313 11.8475 21.4321C11.9939 19.6412 12.2818 18.3852 12.8226 17.3238L11.5752 16.6882C10.9171 17.9799 10.6056 19.4406 10.4522 21.3181C10.2995 23.1875 10.3 25.5312 10.3 28.5999H11.7ZM28.6 10.2999C25.5313 10.2999 23.1876 10.2994 21.3182 10.4521C19.4407 10.6055 17.98 10.917 16.6883 11.5751L17.3239 12.8226C18.3853 12.2817 19.6412 11.9938 21.4322 11.8475C23.2314 11.7005 25.5082 11.6999 28.6 11.6999V10.2999ZM12.8226 17.3238C13.8101 15.3857 15.3858 13.81 17.3239 12.8226L16.6883 11.5751C14.4868 12.6969 12.6969 14.4867 11.5752 16.6882L12.8226 17.3238ZM37.8 31.1666C37.8 34.8301 34.8302 37.7999 31.1667 37.7999V39.1999C35.6034 39.1999 39.2 35.6033 39.2 31.1666H37.8ZM31.1667 37.7999C27.5032 37.7999 24.5333 34.8301 24.5333 31.1666H23.1333C23.1333 35.6033 26.73 39.1999 31.1667 39.1999V37.7999ZM24.5333 31.1666C24.5333 27.5031 27.5032 24.5333 31.1667 24.5333V23.1333C26.73 23.1333 23.1333 26.7299 23.1333 31.1666H24.5333ZM31.1667 24.5333C34.8302 24.5333 37.8 27.5031 37.8 31.1666H39.2C39.2 26.7299 35.6034 23.1333 31.1667 23.1333V24.5333ZM54.4926 43.1818L23.4767 71.3781L24.4184 72.414L55.4343 44.2177L54.4926 43.1818ZM25.9207 77.6999H60.3386V76.2999H25.9207V77.6999ZM73.2685 51.1183L63.012 42.9131L62.1374 44.0063L72.394 52.2115L73.2685 51.1183ZM77.7 60.3385C77.7 58.5962 77.7043 57.6127 77.4874 56.6885L76.1244 57.0085C76.2956 57.7378 76.3 58.5298 76.3 60.3385H77.7ZM72.394 52.2115C73.8063 53.3414 74.4221 53.8396 74.8846 54.4289L75.9859 53.5645C75.3998 52.8177 74.629 52.2067 73.2685 51.1183L72.394 52.2115ZM77.4874 56.6885C77.2202 55.5503 76.7078 54.4842 75.9859 53.5645L74.8846 54.4289C75.4807 55.1883 75.9038 56.0686 76.1244 57.0085L77.4874 56.6885ZM60.3386 77.6999C62.9672 77.6999 64.9747 77.7003 66.5832 77.5874C68.1982 77.474 69.4636 77.2439 70.6017 76.757L70.051 75.4698C69.1168 75.8695 68.0267 76.0826 66.4852 76.1908C64.9371 76.2995 62.9869 76.2999 60.3386 76.2999V77.6999ZM76.3 60.3385C76.3 62.9868 76.2996 64.937 76.1909 66.4851C76.0827 68.0266 75.8696 69.1167 75.4699 70.051L76.7571 70.6016C77.2439 69.4635 77.4741 68.1982 77.5875 66.5831C77.7004 64.9747 77.7 62.9671 77.7 60.3385H76.3ZM70.6017 76.757C73.3688 75.5733 75.5733 73.3687 76.7571 70.6016L75.4699 70.051C74.4278 72.487 72.4871 74.4277 70.051 75.4698L70.6017 76.757ZM23.4767 71.3781C22.6146 72.1619 21.9327 72.7809 21.4612 73.2911C21.0091 73.7802 20.6239 74.2962 20.5579 74.8838L21.9492 75.0401C21.9603 74.9408 22.0499 74.7168 22.4894 74.2413C22.9094 73.7867 23.536 73.2163 24.4184 72.414L23.4767 71.3781ZM25.9207 76.2999C24.7281 76.2999 23.8808 76.2993 23.2642 76.2455C22.6191 76.1893 22.4022 76.0838 22.3272 76.0178L21.4028 77.0693C21.847 77.4597 22.4791 77.5824 23.1426 77.6402C23.8347 77.7006 24.7556 77.6999 25.9207 77.6999V76.2999ZM20.5579 74.8838C20.4655 75.7066 20.781 76.5226 21.4028 77.0693L22.3272 76.0178C22.049 75.7732 21.9079 75.4082 21.9492 75.0401L20.5579 74.8838ZM55.4343 44.2177C56.0996 43.613 56.5701 43.1859 56.9668 42.8767C57.3566 42.5729 57.6351 42.4156 57.9022 42.3289L57.4697 40.9974C56.9867 41.1543 56.5614 41.4177 56.1062 41.7725C55.6579 42.1219 55.1422 42.5913 54.4926 43.1818L55.4343 44.2177ZM63.012 42.9131C62.3264 42.3646 61.7822 41.9286 61.3128 41.6082C60.8361 41.2828 60.3951 41.0467 59.9031 40.9206L59.5554 42.2767C59.8274 42.3465 60.1153 42.4859 60.5235 42.7645C60.9389 43.048 61.4354 43.4446 62.1374 44.0063L63.012 42.9131ZM57.9022 42.3289C58.4372 42.1551 59.0105 42.137 59.5554 42.2767L59.9031 40.9206C59.1011 40.715 58.2572 40.7416 57.4697 40.9974L57.9022 42.3289Z" fill="black"/>
                        </svg>
                    </div>
                }
                <div class="tiny-description py-4 w-full">
                    <div class="text flex gap-2 py-2 justify-center items-center">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.5 12.5V13.5C17.5 14.9001 17.5 15.6002 17.2275 16.135C16.9878 16.6054 16.6054 16.9878 16.135 17.2275C15.6002 17.5 14.9001 17.5 13.5 17.5H6.5C5.09987 17.5 4.3998 17.5 3.86502 17.2275C3.39462 16.9878 3.01217 16.6054 2.77248 16.135C2.5 15.6002 2.5 14.9001 2.5 13.5V12.5M14.1667 6.66667L10 2.5M10 2.5L5.83333 6.66667M10 2.5V12.5" stroke="black" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <p class="text-[#828282]">
                            <span class="font-bold text-black"> Buscar</span>
                        </p>
                    </div>
                    @if (this.showDimentionsText()) {
                        <div class="text flex justify-center items-center">
                            <p class="text-[#aaa] text-xs">
                                Dimens√£o da imagem 1178x523
                            </p>
                        </div>
                    }
                </div>
                <input
                type="file"
                formControlName="file"
                [accept]="allowedFilesWithCommaSeparator()"
                (change)="dropzoneOnChange($event.target)"
                (change)="this.emit()"
                (change)="this.emitOutComeFiles()"
                [id]="'file-' + this.name"
                class=" absolute w-full h-full top-0 left-0 invisible"
                [multiple]="this.multi()">
            </div>
        </label>
    </form>

    @if(errors){
        <div class="errors-container mt-4">
            <small class="text-red-500 text-sm" *ngIf="errors['required'] && isInvalidFromParent()">{{ errors['required'] }}</small>
            <small class="text-red-500 text-sm" *ngIf="errors['fileSize'] && isInvalidFromParent()">{{ errors['fileSize'] }}</small>
            <small class="text-red-500 text-sm" *ngIf="errors['fileType'] && isInvalidFromParent()">{{ errors['fileType'] }}</small>
            <small class="text-red-500 text-sm" *ngIf="errors['totalSize'] && isInvalidFromParent()">{{ errors['totalSize'] }}</small>
        </div>
    }

    @if(this.showPreviewFiles()){
        <div class="uploaded-files mt-8">
            <div class="files flex flex-col gap-y-6" *ngIf="this.files.length > 0">                                
                @for (file of this.files; track $index) {
                    <div class="file p-3 bg-[#f8f8f8] border border-[#e9e9e9] rounded-lg flex gap-x-2 justify-start items-stretch">
                        <div class="image-preview relative! w-14! h-12! rounded overflow-hidden"
                        [ngClass]="{
                            'placeholder': !file.hasLoaded
                        }"
                        >
                            <img
                            (load)="imageHasLoaded($index)"
                            [ngClass]="{
                                'opacity-0': !file.hasLoaded,
                                'opacity-1': file.hasLoaded,
                            }"
                            src="{{ file.previewUrl }}"
                            class="object-fit duration-[.6s] object-center w-full h-full"
                            alt="">
                        </div>
                        <div class="file-details w-full flex justify-between items-center">
                            <div class="main-content w-[340px]">
                                <div class="filename mb-2">
                                    <p class="text-black text-sm font-medium max-w-[340px] limited-text one-line">
                                        {{ file.name }}
                                    </p>
                                </div>
                                <div class="tiny-details flex gap-x-2 justify-start items-center">
                                    <p class="text-[#aaa] text-sm limited-text one-line">
                                        {{ file.size | dataFormat:2 }}
                                    </p>
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <g clip-path="url(#clip0_42_5643)">
                                        <path d="M7.99992 14.6668C11.6818 14.6668 14.6666 11.6821 14.6666 8.00016C14.6666 4.31826 11.6818 1.3335 7.99992 1.3335C4.31802 1.3335 1.33325 4.31826 1.33325 8.00016C1.33325 11.6821 4.31802 14.6668 7.99992 14.6668Z" fill="#61C554"/>
                                        <path d="M4.99992 8.00016L6.99992 10.0002L10.9999 6.00016M14.6666 8.00016C14.6666 11.6821 11.6818 14.6668 7.99992 14.6668C4.31802 14.6668 1.33325 11.6821 1.33325 8.00016C1.33325 4.31826 4.31802 1.3335 7.99992 1.3335C11.6818 1.3335 14.6666 4.31826 14.6666 8.00016Z" stroke="white" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                                        </g>
                                        <defs>
                                        <clipPath id="clip0_42_5643">
                                        <rect width="16" height="16" fill="white"/>
                                        </clipPath>
                                        </defs>
                                    </svg>                                                    
                                </div>
                            </div>
                            <div class="aside-icons">
                                <a (click)="removeFileItem($index)" class="cursor-pointer">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M16 6V5.2C16 4.0799 16 3.51984 15.782 3.09202C15.5903 2.71569 15.2843 2.40973 14.908 2.21799C14.4802 2 13.9201 2 12.8 2H11.2C10.0799 2 9.51984 2 9.09202 2.21799C8.71569 2.40973 8.40973 2.71569 8.21799 3.09202C8 3.51984 8 4.0799 8 5.2V6M10 11.5V16.5M14 11.5V16.5M3 6H21M19 6V17.2C19 18.8802 19 19.7202 18.673 20.362C18.3854 20.9265 17.9265 21.3854 17.362 21.673C16.7202 22 15.8802 22 14.2 22H9.8C8.11984 22 7.27976 22 6.63803 21.673C6.07354 21.3854 5.6146 20.9265 5.32698 20.362C5 19.7202 5 18.8802 5 17.2V6" stroke="#999999" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    }
</div>